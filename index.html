<html lang="nl">
<head>
<meta charset="utf-8"/>
<link href="https://rocket.maximizer.io/favicon.png" rel="icon"/>
<title>Rocket Rapporten</title>
<style>
    :root { 
      --bg-color: #f4f4f4; 
      --text-color: #222; 
      --card-color: #ffffff; 
      --button-color: #007bff; 
      --button-hover: #0056b3; 
    }
    body.dark { 
      --bg-color: #1e1e1e; 
      --text-color: #f1f1f1; 
      --card-color: #2b2b2b; 
      --button-color: #3399ff; 
      --button-hover: #1a75d1; 
    }
    body { 
      font-family: Arial, sans-serif; 
      padding: 40px; 
      background: var(--bg-color); 
      color: var(--text-color); 
      transition: background 0.3s, color 0.3s; 
    }
    .container { max-width: 1200px; margin: 0 auto; position: relative; }
    .header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
    h1 { font-size: 28px; margin: 0; }
    .toggle-container button { 
      background: none; 
      border: 1px solid var(--text-color); 
      padding: 6px 12px; 
      color: var(--text-color); 
      cursor: pointer; 
      border-radius: 5px; 
      font-size: 14px; 
    }
    .card { 
      background: var(--card-color); 
      border-radius: 8px; 
      padding: 20px; 
      margin-bottom: 20px; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.08); 
    }
    .card .label { font-size: 16px; font-weight: bold; margin-bottom: 12px; }
    .buttons { display: flex; flex-wrap: wrap; gap: 10px; }
    button.action-button { 
      padding: 8px 14px; 
      font-size: 14px; 
      cursor: pointer; 
      border: none; 
      background: var(--button-color); 
      color: white; 
      border-radius: 5px; 
      transition: all 0.2s ease; 
      box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
      height: 35px;
      display: flex;
      align-items: center;
      box-sizing: border-box;
    }
    button.action-button:hover { 
      transform: translateY(-1px); 
      box-shadow: 0 4px 8px rgba(0,0,0,0.15); 
      background: var(--button-hover); 
    }
    
    .refresh-btn { 
      background: none; 
      border: none; 
      cursor: pointer; 
      font-size: 22px; 
      color: var(--text-color); 
      padding: 0 5px; 
      display: inline-flex; 
      align-items: center; 
      justify-content: center;
      height: 35px; 
      line-height: 1;
      box-sizing: border-box;
      vertical-align: middle;
      transition: transform 0.2s;
    }
    .refresh-btn:active { transform: scale(0.9); }
    
    .spin-animation {
      animation: spin 0.6s ease-in-out;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .top-controls { display: flex; align-items: center; gap: 30px; }
    .calendar-section { 
      padding-right: 30px; 
      border-right: 1px solid #ccc; 
      display: flex; 
      flex-direction: column; 
      gap: 12px; 
      flex-shrink: 0; 
    }
    .search-stack { display: flex; flex-direction: column; gap: 10px; flex-grow: 1; }
    .inline-row { display: flex; align-items: center; gap: 12px; }
    .fixed-label { min-width: 130px; font-weight: 500; white-space: nowrap; }
    .search-input { flex-grow: 1; max-width: 350px; }
    .search-button { min-width: 140px; text-align: center; justify-content: center; }
    
    input[type="date"], input[type="text"], select { 
      font-family: inherit; 
      font-size: 14px; 
      color: var(--text-color); 
      background: var(--card-color); 
      padding: 6px 10px; 
      border: 1px solid #ccc; 
      border-radius: 5px; 
      outline: none;
      height: 35px; 
      box-sizing: border-box;
    }

    @media (max-width: 1100px) { 
      .top-controls { flex-direction: column; align-items: stretch; } 
      .calendar-section { border-right: none; border-bottom: 1px solid #ccc; padding-bottom: 20px; } 
    }
    .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    @media (max-width: 900px) { .two-col { grid-template-columns: 1fr; } }

    /* Extra styling voor de keuzeknop */
    .dropdown { position: relative; display: inline-block; }
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: var(--card-color);
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 10;
      border-radius: 5px;
      bottom: 100%;
      margin-bottom: 5px;
    }
    .dropdown-content a {
      color: var(--text-color);
      padding: 10px 12px;
      text-decoration: none;
      display: block;
      font-size: 13px;
      border-bottom: 1px solid #ccc;
    }
    .dropdown-content a:last-child { border-bottom: none; }
    .dropdown-content a:hover { background-color: var(--button-color); color: white; }
    .dropdown:hover .dropdown-content { display: block; }
</style>
</head>
<body>
<div class="container">
  <div class="header-row">
    <h1>ðŸš€ Rocket Rapporten</h1>
    <div class="toggle-container">
      <button id="themeToggleBtn" onclick="toggleDarkMode()">ðŸŒ™ Donkere modus</button>
    </div>
  </div>

  <div class="card">
    <div class="top-controls">
      <div class="calendar-section">
        <div class="inline-row">
          <span class="fixed-label">Periode:</span>
          <input id="fromDate" type="date"/>
          <span>t/m</span>
          <input id="toDate" type="date"/>
          <button id="refreshBtn" class="refresh-btn" onclick="resetFilters()" title="Filters wissen">ðŸ”„</button>
        </div>
        <div class="inline-row">
          <span class="fixed-label">Selecteer Feed:</span>
          <select id="feedSelector" style="flex-grow: 1;">
            <option value="ALL">-- Alle Feeds --</option>
            <option value="Maximizer Feed 1 (organizertone.com)">Maximizer Feed 1 (organizertone.com)</option>
            <option value="Maximizer Feed 1 (wantedpipe.com)">Maximizer Feed 1 (wantedpipe.com)</option>
            <option value="Maximizer Feed 1 (targetjunction.com)">Maximizer Feed 1 (targetjunction.com)</option>
            <option value="Maximizer Feed 1 (nationkernel.com)">Maximizer Feed 1 (nationkernel.com)</option>
            <option value="Maximizer Feed 3 (goodprojectideas.com)">Maximizer Feed 3 (goodprojectideas.com)</option>
            <option value="Maximizer Sedo (allinfocenters.com)">Maximizer Sedo (allinfocenters.com)</option>
            <option value="Maximizer Inuvo (travelingagain.com)">Maximizer Inuvo (travelingagain.com)</option>
            <option value="Blogic Airfind">Blogic Airfind</option>
            <option value="Maximizer Stellar (explorerdigest.com)">Maximizer Stellar (explorerdigest.com)</option>
          </select>
        </div>
        <button class="action-button" onclick="handleOpenCustomAll()" style="justify-content: center;">Open (alle campagnes)</button>
      </div>
      <div class="search-stack">
        <div class="inline-row">
          <span class="fixed-label">Campaign Name:</span>
          <input id="campaignQuery" class="search-input" type="text" placeholder="Voer campaign name in" />
          <button class="action-button search-button" onclick="handleSearchCampaign()">Zoek op naam</button>
        </div>
        <div class="inline-row">
          <span class="fixed-label">Campaign ID:</span>
          <input id="campaignIdQuery" class="search-input" type="text" placeholder="Voer campaign id in" />
          <button class="action-button search-button" onclick="handleSearchById()">Zoek op ID</button>
        </div>
      </div>
    </div>
  </div>

  <div class="card hero">
    <div class="label" style="text-align:center;">ðŸ”Ž Alle campagnes</div>
    <div class="buttons" style="justify-content:center;">
      <button class="action-button" onclick="openReport('', 'today')">Vandaag</button>
      <button class="action-button" onclick="openReport('', 'yesterday')">Gisteren</button>
      <button class="action-button" onclick="openHourly('today')">Uren vandaag</button>
      <button class="action-button" onclick="openHourly('yesterday')">Uren gisteren</button>
      <button class="action-button" onclick="openD2D()">D2D</button>
      <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1pcaDGNZmGRt5cV8aUGC1eMUPLo8A_aXBlMvVHfvXuSg/edit?gid=1072646418#gid=1072646418', '_blank')">Parentsheet</button>
      <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/14J5aJfmYfS1kykiIfzA0hTG3UHz80r2MyHcicfTacws/edit?gid=118875398#gid=118875398', '_blank')">Informationsheet</button>
    </div>
  </div>

  <div class="two-col">
    <div class="col">
      <div class="card"><div class="label">Jim</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sjh', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sjh', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sjh')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sjh')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1kT_9Yy1SrSLJxcvR4ydH_FukL1firLml2udxDqxsk9M/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>

      <div class="card">
        <div class="label">Julian</div>
        <div class="buttons">
          <button class="action-button" onclick="openReport('- sjb', 'today')">Vandaag</button>
          <button class="action-button" onclick="openReport('- sjb', 'yesterday')">Gisteren</button>
          <button class="action-button" onclick="openHourly('today', '- sjb')">Uren vandaag</button>
          <button class="action-button" onclick="openHourly('yesterday', '- sjb')">Uren gisteren</button>
          <div class="dropdown">
            <button class="action-button">Worksheet</button>
            <div class="dropdown-content">
              <a href="https://docs.google.com/spreadsheets/d/1MWX0IbBoIQmB4o0V4qVSvlPhn-G3_4bS3QIQAq5Hpfo/edit?gid=1493191612#gid=1493191612" target="_blank">Worksheet 1 </a>
              <a href="https://docs.google.com/spreadsheets/d/1Oh1_J1s-Yk-gD86DzrI9by_BgMbHD-2UrGld4Ln7G-M/edit?gid=138020018#gid=138020018" target="_blank">Worksheet 2 </a>
            </div>
          </div>
        </div>
      </div>
      
      <div class="card"><div class="label">Lukas</div><div class="buttons">
        <button class="action-button" onclick="openReport('- slj', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- slj', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- slj')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- slj')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1wvIGj7297Bu8wQcpVVOaG2utARy8eRefxy3bu74DMwM/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Sem</div><div class="buttons">
        <button class="action-button" onclick="openReport('- ssu', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- ssu', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- ssu')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- ssu')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1tTyKpfDfp2wTg6YKMhb4_glpierS7g5DKgp_hQaHVnY/edit?gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Niels</div><div class="buttons">
        <button class="action-button" onclick="openReport('- snh', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- snh', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- snh')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- snh')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1tUjqT4TQVJBbxuN4sFcalQ8jZ0I_vhSKck6iOtyv1dQ/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Bram</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sbl', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sbl', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sbl')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sbl')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1Uu5XuNv0umFlDQmBOMBqBZVMgbevNQrL92ScAbcPvnU/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Stijn</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sss', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sss', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sss')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sss')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/17JGJvjH1EPjlmwMaHJ8nN5Dv-e13a7CwEu9sHe7Y6Mc/edit?gid=1042481573#gid=1042481573', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Olaf</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sod', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sod', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sod')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sod')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1VAN5BKDW7TdOAG-nXD6WiEjyGERt97Eb-z1jK67jR54/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Julian R</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sjr', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sjr', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sjr')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sjr')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1LCZ05qG9A-YjgrUVMbm3sBkEToWB5fubA2o2LvuqLmg/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
    </div>

    <div class="col">
      <div class="card"><div class="label">Sebastian</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sse', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sse', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sse')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sse')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/15EI3EDCGKmq3Db42nmRfIGVjvSCMPdgJhY_3OQjHe6M/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Ejla</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sep', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sep', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sep')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sep')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1cTfYY5fipXojhSludGEsQxCj1KFqd_LOs4N0Hol65ms/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Wouter</div><div class="buttons">
        <button class="action-button" onclick="openReport('- swb', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- swb', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- swb')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- swb')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/14fbPQgc2CSWO7lOZ8rIibimqCK4bJ-G5uZZcPkgE_c0/edit?gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Richard</div><div class="buttons">
        <button class="action-button" onclick="openReport('- srz', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- srz', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- srz')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- srz')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/14QJVhBZnC0xV5TG7z9hvSjWHYMAESSB9uOShaAo5vWQ/edit?gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Luc</div><div class="buttons">
        <button class="action-button" onclick="openReport('- slr', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- slr', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- slr')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- slr')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1bG3-ah_-bTAC80xX9B83OkjMEBvZsnc3qPlhteLBnrw/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Giovanni</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sgv', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sgv', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sgv')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sgv')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1bGmd7204kBpp2iykwrZips_vQWluXp0F8SobE0UQHcE/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Sander</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sst', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sst', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sst')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sst')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1yYa5y1px5pOFcyTtwQeyIwczKd_b5hSFy6EWggt6FyM/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Owen</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sow', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sow', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sow')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sow')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/18cTuQo9hIoquIBbeNoPHCQ0zwzRp-B2yrGfDlhFO7kc/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
      <div class="card"><div class="label">Kevin</div><div class="buttons">
        <button class="action-button" onclick="openReport('- sks', 'today')">Vandaag</button>
        <button class="action-button" onclick="openReport('- sks', 'yesterday')">Gisteren</button>
        <button class="action-button" onclick="openHourly('today', '- sks')">Uren vandaag</button>
        <button class="action-button" onclick="openHourly('yesterday', '- sks')">Uren gisteren</button>
        <button class="action-button" onclick="window.open('https://docs.google.com/spreadsheets/d/1IcbiHJ6r7zi5zJgaanNR-1dm44hjpo4jhIf1KhVJ4yg/edit?gid=1426903825#gid=1426903825', '_blank')">Worksheet</button>
      </div></div>
    </div>
  </div>

  <script>
    function formatDate(date) { return date.toISOString().slice(0, 10); }

    // Nieuwe helper functie om de geselecteerde feed op te halen
    function getFeedFilter() {
      const feed = document.getElementById('feedSelector').value;
      return (feed === 'ALL') ? '' : `&filter=feedName:eq:${encodeURIComponent(feed)}`;
    }

    // Nieuwe helper om feedName aan dimensions toe te voegen als een feed geselecteerd is
    function getDimensions(baseDims) {
      const feed = document.getElementById('feedSelector').value;
      return (feed === 'ALL') ? baseDims : `${baseDims},feedName`;
    }

    function openD2D() {
      const nu = new Date();
      const firstDay = formatDate(new Date(nu.getFullYear(), nu.getMonth(), 1));
      const today = formatDate(nu);
      const url = `https://rocket.maximizer.io/stats?dateStart=${firstDay}&dateEnd=${today}&dimensions=date&metrics=cpa,rpc,spend,revenue,profit,roi&filter=spend:gt:1&sort=-date&style=flat${getFeedFilter()}`;
      window.open(url, '_blank');
    }

    function resetFilters() {
      const btn = document.getElementById('refreshBtn');
      btn.classList.add('spin-animation');
      document.getElementById('fromDate').value = '';
      document.getElementById('toDate').value = '';
      document.getElementById('campaignQuery').value = '';
      document.getElementById('campaignIdQuery').value = '';
      document.getElementById('feedSelector').value = 'ALL';
      setTimeout(() => { btn.classList.remove('spin-animation'); }, 600);
    }

    function openReport(campagne, range, isId = false) {
      const nu = new Date();
      let dStart, dEnd;
      if (range === 'today') { dStart = dEnd = formatDate(nu); } 
      else { dStart = dEnd = formatDate(new Date(nu.getTime() - 86400000)); }

      let dims = getDimensions("campaignName,query,campaignID,campaignStatus,adsetDailyBudget");
      let url = `https://rocket.maximizer.io/stats?dateStart=${dStart}&dateEnd=${dEnd}&dimensions=${dims}&metrics=cpa,rpc,spend,revenue,profit,roi`;
      
      if (campagne) {
        url += isId ? `&filter=campaignID:eq:${campagne}` : `&filter=campaignName:cn:${campagne}`;
      }
      
      // Voeg feed filter en standaard filters toe
      url += `${getFeedFilter()}&filter=spend:gt:1&sort=-profit&style=flat`;
      window.open(url, '_blank');
    }

    function openHourly(range, campagne = '') {
      const nu = new Date();
      let ds = (range === 'today') ? formatDate(nu) : formatDate(new Date(nu.getTime() - 86400000));
      let dims = getDimensions("hour");
      let url = `https://rocket.maximizer.io/stats?dateStart=${ds}&dateEnd=${ds}&dimensions=${dims}&metrics=cpa,rpc,spend,revenue,profit,roi`;
      if (campagne) url += `&filter=campaignName:cn:${campagne}`;
      
      url += `${getFeedFilter()}&filter=spend:gt:1&sort=hour&style=flat`;
      window.open(url, '_blank');
    }

    function openReportWithDates(campagne, ds, de, isId = false) {
      if (!ds || !de) { alert('Kies datums.'); return; }
      let dims = "campaignName,campaignID,campaignStatus,sourceProvider,adsetDailyBudget";
      if (ds !== de) dims = "date," + dims;
      dims = getDimensions(dims);

      let url = `https://rocket.maximizer.io/stats?dateStart=${ds}&dateEnd=${de}&dimensions=${dims}&metrics=cpa,rpc,spend,revenue,profit,roi`;
      if (campagne) url += isId ? `&filter=campaignID:eq:${campagne}` : `&filter=campaignName:cn:${campagne}`;
      
      let sortField = (ds !== de) ? "-date" : "-profit";
      url += `${getFeedFilter()}&filter=spend:gt:1&sort=${sortField}&style=flat`;
      window.open(url, '_blank');
    }

    function handleOpenCustomAll() { openReportWithDates('', document.getElementById('fromDate').value, document.getElementById('toDate').value); }
    
    function handleSearchCampaign() {
      const input = document.getElementById('campaignQuery');
      let q = input.value.trim();
      let f = document.getElementById('fromDate').value, t = document.getElementById('toDate').value;
      if (q) { 
        if (f && t) openReportWithDates(q, f, t); else openReport(q, 'yesterday'); 
        input.value = '';
      }
    }
    
    function handleSearchById() {
      const input = document.getElementById('campaignIdQuery');
      let q = input.value.trim();
      let f = document.getElementById('fromDate').value, t = document.getElementById('toDate').value;
      if (q) { 
        if (f && t) openReportWithDates(q, f, t, true); else openReport(q, 'yesterday', true); 
        input.value = '';
      }
    }

    function toggleDarkMode() {
      const isDark = document.body.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      document.getElementById('themeToggleBtn').textContent = isDark ? 'â˜€ï¸ Lichte modus' : 'ðŸŒ™ Donkere modus';
    }
    
    if(localStorage.getItem('theme') === 'dark') { 
        document.body.classList.add('dark'); 
        document.getElementById('themeToggleBtn').textContent = 'â˜€ï¸ Lichte modus'; 
    }

    document.getElementById('campaignQuery').addEventListener('keydown', (e) => { if (e.key === 'Enter') handleSearchCampaign(); });
    document.getElementById('campaignIdQuery').addEventListener('keydown', (e) => { if (e.key === 'Enter') handleSearchById(); });
  </script>
</div>
</body>
</html>
